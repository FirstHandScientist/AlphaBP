\documentclass[conference,onecolumn]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithm,algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

% \documentclass{article}

\usepackage{hyperref} %BUG if put after
\usepackage{tikz}
\usetikzlibrary{calc,shapes,positioning}
\usetikzlibrary{arrows}
\newcommand{\midarrow}{\tikz \draw[-triangle 90] (0,0) -- +(.1,0);}
% Be sure to use PDxF Latex
\pdfoutput=1

% \usepackage[latin1]{inputenc}

\usepackage{url}
% \usepackage{fullpage}
\usepackage{cite}
% \usepackage{caption}
\usepackage{bm}
\newcommand{\ubar}[1]{\mkern2mu\underline{\mkern-2mu #1\mkern-2mu}\mkern2mu}
% \allowdisplaybreaks
\usepackage{mystyle}


\usepackage{amsmath,graphicx}
% format A4
% \usepackage{vmargin}
% \setpapersize{A4} 

\RequirePackage{algorithm}
\RequirePackage{algorithmic}

% Attempt to make hyperref and algorithmic work together better:
% \newcommand{\theHalgorithm}{\arabic{algorithm}}

\hypersetup{  
  bookmarks=true,
  backref=true,
  pagebackref=false,
  colorlinks=true,
  linkcolor=blue,
  citecolor=red,
  urlcolor=blue,
  pdftitle={alphaBP},
  pdfauthor={Dong Liu},
  pdfsubject={}
}

\captionsetup[figure]{labelformat={default},labelsep=period,name={Figure}}

\begin{document}
\title{$\alpha$ Belief Propagation as Fully Factorized Approximation}
\author{First Hand Scientists\\
e-mail: doli@kth.se}
% \author{
%   \IEEEauthorblockN{
%     Dong Liu$^{1}$, Nima N. Moghadam$^{2}$, Lars~K. Rasmussen$^{1}$, Jinliang Huang$^{2}$, Saikat Chatterjee$^{1}$}

%   \IEEEauthorblockA {$^{1}$ KTH Royal Institute of Technology, Stockholm, Sweden. }
%   \IEEEauthorblockA {$^{2}$ Huawei Technologies Sweden AB, Stockholm, Sweden.}
%   \IEEEauthorblockA{
%     e-mail: \{doli, lkra, sach\}@kth.se, \{nima.najari.moghadam1, jinliang.huang\}@huawei.com}
% }



\maketitle
\begin{abstract}
  Belief propagation (BP) can do exact inference in loop-free graphs, but its performance could be poor in graphs with loops, and the understanding of its solution is limited.
  This work gives an interpretable belief propagation rule that is actually minimization of a localized $\alpha$-divergence. We term this algorithm as $\alpha$ belief propagation ($\alpha$-BP). % By $\alpha$-BP, any inference on a distribution $p$ is approximately answered by a fully factorized surrogate distribution $q$.
  The performance of $\alpha$-BP is tested in MAP (maximum a posterior) inference problems, where
  $\alpha$-BP can outperform (loopy) BP by a significant margin even in fully-connected graphs. 
  % \\
  % Choice2: This work follows Tom Minka's work and proposes a generalization for standard belief propagation (BP), which we denote by $\alpha$-BP. Similarly to BP, $\alpha$-BP can be interpreted as an approximate inference scheme in which an intractable distribution is approximated by a fully-factorized and tractable one. It is well-known that on non-sparse graphs conventional message passing algorithms such as loopy-BP almost always fails to converge. However, using numerical results in a linear system, we show that $\alpha$-BP can outperform BP by a significant margin even in a fully-connected graph. 
  
  % a fully factorized distribution to approximate an target distribution and  obtains $\alpha$ Belief Propagation ($\alpha$-BP), which generalizes standard BP. $\alpha$-BP can be interpreted as approximating a distribution $p$ by a fully factorized distribution $q$. Then the Bayesian inference problems on $p$ (usually computational expensive) can be approximately answered by relatively simple surrogate $q$. Message passing of $\alpha$-BP is obtained by a exemplified linear model. Numerical results on \textit{maximum a posterior} inference are reported.
\end{abstract}

\section{Introduction}\label{sec:introduction}
Bayesian inference provides a general mathematical framework for many learning tasks such as classification, denoising, object detection, and signal detection. The wide applications include but not limited to imaging processing \cite{zhang2013denoise}, multi-input-multi-output (MIMO) signal detection in digital communication \cite{cespedes2014ep,jeon2015optimality}, inference on structured lattice \cite{10.2307/25651244}, machine learning  \cite{2018arXiv180607066M, Lin:2015:DLM:2969239.2969280, yoon2019inferenceGraph}.
Specifically, statistic properties of a hidden variable $\bm{x} = \{x_1,\dots,x_N\}$ are of common interests in Bayesian inference. Practical interests usually include finding joint probability $p(\bm{x})$, marginal probability $p_i(x_i)$, the most probable state $\argmax_{\bm{x}} p(\bm{x})$. It can be extended to maximum a posterior (MAP) inference when it is conditional on some observation ($\argmax_{\bm{x}}p(\bm{x} | \cdot)$). Direct inference from $p(\bm{x})$ may be difficult computationally or technically. For instance, in the MAP inference problem, it could be the case that the gradient or subgradient of $p(\bm{x})$ may not exist and it is computationally prohibitive to search $\bm{x}$'s whole feasible space.


Probabilistic graphical models as structured graphs provide a framework for modeling the dependency between random variables. Belief propagation (BP) is a general message-passing algorithm for performing inference on graphical models. The intuition of BP is exchange of belief (statistical information) between neighboring nodes \cite{Bishop:2006:PRM:1162264}. When belief exchange converges, inference can be done by using the converged belief in graphical models. BP can solve inference problems exactly when the graphical model representation of $p(\bm{x})$ is loop-free or tree-structured \cite{kschischang2001factor_graph}.
When there are loops or circles in graphical models, BP is still a practical method to do inference approximately (loopy BP) by running it as if there is no loop. But its performance could be deteriorated significantly. In the loopy case,
there are attempts to study convergence properties of BP in special cases \cite{Ihler:2005:LBP:1046920.1088703, du2017convergenceBP}, but (loopy) BP may not converge in general.

Apart from the practical performance issues of BP in loopy graphs, the understanding of it is also limited. \cite{Yedidia:2000:GBP:3008751.3008848} shows that BP in loopy graphs approaches to a stationary point of an approximate free energy, the Bethe free energy in statistical physics. Based on this understanding, variants of BP are derived to improve BP. For instance, fractional BP in \cite{Wiegerinck:2002:FBP:2968618.2968673} applies a correction coefficient to each factor, generalized BP \cite{Yedidia:2000:GBP:3008751.3008848} propagates belief between different regions of a graph, and damping BP in \cite{Pretti2005damping} updates belief by combining old and new belief. Another track is expectation propagation (EP), introduced by Opper and Winther \cite{Opper:2000:GPC:1121900.1121911} and Minka \cite{Minka:2001:EPA:647235.720257, Minka:2001:FAA:935427}. In EP, a simpler factorized distribution defined in exponential distribution family is used to approximate the original complex distribution, and an intuitive factor-wise refinement procedure is used to find such an approximate distribution. The method has an intuition of minimizing a localized Kullback-Leibler (KL) divergence. This is discussed further in \cite{divergence-measures-and-message-passing} and it shows an unifying view of message passing algorithms. Following work stochastic EP \cite{yingzhen2015sep} explores its variant method for applications to large dataset.

In this work, we take the path of Minka's variational methods to improve BP and also to gain better understanding of BP in loopy graphs.
We define a surrogate distribution $q(\bm{x})$ first. $q(\bm{x})$ is assumed to be fully factorized and each factor of $q(\bm{x})$ represents a message in the factor graph representation of the original distribution $p(\bm{x})$. Fully factorization is the only requirement to $q(\bm{x})$. Then we define a message passing rule that is derived by minimizing a localized $\alpha$-divergence. This is factor-wise refinement of $q(\bm{x})$ iteratively. We refer to the obtained algorithm by $\alpha$-BP. The merits of $\alpha$ are as follows:
\begin{itemize}
\item[a.]{$\alpha$-BP has clear intuition as localized minimization of $\alpha$-divergence between original distribution $p$ and surrogate distribution $q$.}
\item[b.]{$\alpha$-BP generalizes the standard BP, since the message rule of BP is a special case of $\alpha$-BP.}
\item[c.]{$\alpha$}-BP could outperform BP significantly even in full-connected graphs while still maintaining simplicity of BP for inference. 
\end{itemize}

% It turns out the   Choice of $\alpha$ value affects the performance of $\alpha$-BP according our numerical results. $\alpha$-BP outperforms BP and MMSE in the exemplified linear model that is tested in our experiments this paper.

% -------------------------------------------------------

% Then try to minimize the information loss by using $q(\bm{x})$ to represent $p(\bm{x})$.  We follow Minka's work \cite{divergence-measures-and-message-passing} to make these steps feasible:
% \begin{itemize}
% \item Pick $q$ from a distribution family;
% \item Pick a divergence to measure the information loss due to use $q$ to represent $p$;
% \item Construct an optimization plan to approximate $p$ by $q$ with criteria of selected divergence;
% \item Propagate the optimization across factor graph.
% \end{itemize}
% Then we estimate the most probable $\bm{x}$ from $q(\bm{x})$.
% Fully factorized $q(\bm{x})$ is chosen such that we can avoid the search of whole discrete space $\Aa^{N}$. For the criteria selection, we use $\alpha$-divergence which generalize the classic Kullback-Leibler (KL) divergence. We refer to the obtained algorithm as $\alpha$-BP.


% When $\bm{x}$ is defined in unconstrained continuous space $\Rr^N$, the MAP inference problem may comes with closed-form solution. For instance, minimum mean square error (MMSE) in linear system. For cases where there is no closed-form solution, gradient decent based optimization methods \cite{DBLP:journals/corr/KingmaB14} could be applied to find the most probable $\bm{x}$ with target of maximizing the $p(\bm{x})$ (or log-likelihood) directly or using variational Bayesian \cite{DBLP:journals/corr/KingmaW13}.





% ---------------------------------------------------------------------
% Motivation starts from MRF and linear system, target to find most likely configuration/signal,
% 1. continuous support, $\Rr^n$, closed form or optimization algorithm
% 2. discrete finite support, no-closed form nor optimization method
% examples: compressed sensing, MIMO detection

% Introduction to graphical model and BP, this is usually used to cope with this problem here. Problem is the loopy graph, where performance is bad. Another problem is the leaf-root belief propagation explanation is gone loopy graph, since it is not tree structure any more.

% In this work, we attempt the problem via looking for fully factorized approximation to true posterior, by minimizing alpha-divergence in a heuristic fixed-point scheme. $\alpha$-BP It turns out this generalize the standard BP. \\
% 1. improvement can be achieved by alternating the choice of alpha value in $\alpha$-divergence. \\
% 2. Run $\alpha$-BP with prior belief from other low cost estimation, help further impove the configuration estimation.





\section{Preliminary}\label{sec:preliminary}
In this section, we provide the preliminaries that are needed in this paper. We introduce the $\alpha$-divergence and a graphical model that we are going to use to explain $\alpha$-BP.

\subsection{Divergence Measures}
As explained in Section~\ref{sec:introduction}, we are going to minimize $\alpha$-divergence between $p$ and $q$, which is defined as follows according to \cite{Zhu95informationgeometric}\cite{divergence-measures-and-message-passing}: \\
\begin{equation}\label{eq:alpha-divergence}
  \Dd_{\alpha}(p \| q ) = \frac{\int_{\bm{x}} \alpha p(\bm{x}) + (1-\alpha) q (\bm{x}) - p(\bm{x})^{\alpha} q(\bm{x})^{1-\alpha} d\bm{x}}{\alpha(1-\alpha)},
\end{equation}
where $\alpha$ is the parameter of $\alpha$-divergence, distribution $p$ and $q$ are unnormalized, i.e. $\int_{\bm{x}}p(\bm{x}) d\bm{x} \neq 1$, $\int_{\bm{x}}q(\bm{x}) d\bm{x} \neq 1$.

The classic KL divergence is defined as
\begin{equation}
  KL(p \| q) = \int p(\bm{x}) \log{\frac{p(\bm{x})}{q(\bm{x})}} d \bm{x}+ \int q(\bm{x}) - p(\bm{x}) d\bm{x}
\end{equation}
where the $\int q(\bm{x}) - p(\bm{x}) d\bm{x}$ is a correction factor to accommodate unnormalized $p$ and $q$. The KL divergence is a special case of $\alpha$-divergence, since $\lim_{\alpha \rightarrow 1}\Dd_{\alpha}(p \| q ) = KL(p\|q)$ and $\lim_{\alpha \rightarrow 0}\Dd_{\alpha}(p \| q ) = KL(q\|p)$, by applying L'H\^opital's rule to \autoref{eq:alpha-divergence}.

Both $\alpha$-divergence and KL divergence are equal to zero if $p=q$, and they are non-negative (therefore satisfy the basic property of error measure).
Denote KL-projection by
\begin{equation}
  \text{proj}[p] = \uargmin{q \in \Ff} KL(p\|q),
\end{equation}
where $\Ff$ is the distribution family of $q$.

According to the stationary point equivalence Theorem in \cite{divergence-measures-and-message-passing}, $\text{proj}[p^{\alpha}q^{1- \alpha}]$ and $\Dd_{\alpha}(p\|q)$ have same stationary points. A heuristic scheme to find $q$ minimizing $\Dd_{\alpha}(p\|q)$ is to find its stationary point by a fixed-point iteration:
\begin{equation}\label{eq:fixed-point-iter}
  q(\bm{x})^{\text{new}}  = \text{proj}[p(\bm{x})^{\alpha}q(\bm{x})^{1-\alpha}].
\end{equation}

\subsection{A Graphic Model}

\begin{figure}
  \begin{centering}
    \begin{tikzpicture}
      % \tikzstyle{enode} = [thick, draw=blue, circle, inner sep = 3pt,
      % align=center]
      \tikzstyle{enode} = [thick, draw=blue, circle, inner sep = 4pt,  align=center]
      \tikzstyle{nnode} = [thick, rectangle, rounded corners = 2pt,minimum size = 0.8cm,draw,inner sep = 2pt]

      \tikzstyle{cnode} = [thick, cloud, draw,cloud puffs=10, cloud puff arc=120, aspect=2, inner ysep=4pt]

      \node[cnode] (pajk) at (3, 1.5) {$\Tt_{\text{Pa}[j]\backslash k}$};
      \node[cnode] (paik) at (-3, 1.5) {$\Tt_{\text{Pa}[i]\backslash k}$};

      \node[nnode] (tk) at (0, 1.5) {$t_k(x_i, x_j)$};
      \node[enode] (xi) at (-1.5 ,0) {$x_i$};
      \node[nnode] (fi) at (-1.5 , -1.5) {$f_i(x_i)$};

      \node[enode] (xj) at (1.5 ,0) {$x_j$};
      \node[nnode] (fj) at (1.5 , -1.5) {$f_j(x_j)$};
      % connections

      \draw[-] (xi) to (fi);
      \draw[-] (xi) to (tk);
      \draw[-] (xi) to (paik);

      \draw[-] (xj) to (fj);
      \draw[-] (xj) to (tk);
      \draw[-] (xj) to (pajk);
    \end{tikzpicture}
    \caption{Factor graph illustration of \autoref{eq:mrf}.}\label{fig:factor-graph}
    \vspace{0.1cm}
  \end{centering}
\end{figure}
We introduce a pairwise Markov random field (MRF) $p(\bm{x})$ to
explain our algorithm. Variable $\bm{x} := \left\{ x_1, x_2, \cdots,
  x_N \right\}$, where $x_i \in \Aa$ is a discrete finite set or subset of
$\RR$, and $N$ is a positive integer.
An undirected graphical model, known as Markov random field, defines a
family of joint probability distributions over $\bm{x}$ by associating
its index set with the vertex set $\Vv$ of undirected graph
$\Gg:=(\Vv, \Ee)$. The graph contains edges $\Ee \subset \Vv \times
\Vv$, where a pair of $(v, u) \in \Ee$ if and only if nodes $v$ and
$u$ are connected by a edge. For a clique $\Cc$ of the graph, let
$\phi_{\Cc}: \Aa^{\abs{\Cc}} \rightarrow (0, \infty)$ be a potential
function of vector $\bm{x}_{\Cc}:=\left\{ x_v| v\in \Cc \right\}$. Let
us then write the joint distribution of $\bm{x}$ as
\begin{equation}\label{eq:mrf}
  p(\bm{x}) \propto \prod_{{v\in \Vv}} \phi_v(x_) \prod_{(v,u) \in \Ee} \phi_{vu}(x_v, x_u),
\end{equation}
where $\propto$ denotes the fact that the only difference between two sides of $\propto$ is a constant factor.

The factor graph representing \autoref{eq:mrf} is shown in \autoref{fig:factor-graph}. In the figure, $\text{Pa}[i]$ is the index set of pairwise factors connecting to variable node $x_i$, i.e. $\text{Pa}[i]$ is subset of $\Kk$, $\backslash$ denotes exclusion. $\Tt_{\text{Pa}[i]\backslash k}$ is the product of all pairwise factors connecting to $x_i$ except for $t_k$:
\begin{equation}
  \Tt_{\text{Pa}[i]\backslash k} = \prod_{n \in \text{Pa}[i]\backslash k}t_n.
\end{equation}


% Since the KL-projection onto a 

% Lemma of alpha-divergence minimization, where the fully-factorized solution should be given\\

\section{$\alpha$-BP as Fully-Factorized Approximation}
In this section, we will show why $\alpha$-BP as a message-passing algorithm can be used as a fully-factorized approximation to the original distribution $p(\bm{x})$. 




\subsection{$\alpha$ Belief Propagation}
\subsubsection{Fully Factorized Surrogate}
Now we formulate a surrogate distribution as
\begin{equation}
    q(\bm{x}) \propto \prod_{{v\in \Vv}} \tilde{\phi}_v(x_) \prod_{(v,u) \in \Ee} \tilde{\phi}_{vu}(x_v, x_u),
\end{equation}
to approximate $p(\bm{x})$. The surrogate distribution would be used to estimate inference problems of $p(\bm{x})$. We further assume that $q(\bm{x})$ can be fully factorized, which means that $\tilde{\phi}_{v,u}(x_v, x_u)$ can be factorized as two independent functions of $x_v, x_u$ respectively. We denote this factorization as
\begin{equation}
  \tilde{\phi}_{v,u}(x_v, x_u) := m_{uv}(x_v) m_{vu}(x_u).
\end{equation}
We use the notation $m_{uv}(x_v)$ to denote the factor as a function of $x_v$ due to the intuitive fact that $m_{uv}$ is also the message from the factor $\phi_{uv}(x_u, x_v)$ to variable node $x_v$. Similarly we have factor $m_{vu}(x_u)$. Then the marginal can be formulated straightforwardly as
\begin{equation}
  q_v(x_v) \propto \tilde{\phi}_v(x_v) \prod_{w\in \Nn(v)} m_{wv}(x_v).
\end{equation}

\subsubsection{Local $\alpha$-Divergence Minimization}

Now, we are going to use the heuristic scheme as in \autoref{eq:fixed-point-iter} to minimize the information loss by using tractable $q(\bm{x})$ to represent $p(\bm{x})$. The information loss is measured by $\alpha$-divergence $\Dd_{\alpha}(p(\bm{x}) \| q(\bm{x}))$.

We do factor-wise refinement to update the factors of $q(\bm{x})$ such that $q(\bm{x})$ approaches $p(\bm{x})$ asymptotically similar to \cite{divergence-measures-and-message-passing,Minka:2001:EPA:647235.720257}. Without losing generality, we begin to refine factor $\tilde{\phi}_{uv}(x_u, x_v)$. Define $q^{\backslash (u,v)}(\bm{x})$ as all other factors except for $\tilde{\phi}_{uv}(x_u, x_v)$
\begin{equation}
  q^{\backslash k}(\bm{x}) = q(\bm{x})/\tilde{\phi}_{uv}(x_u, x_v)
  \propto \prod_{{v\in \Vv}} \tilde{\phi}_v(x_) \prod_{(v,u) \in
    \Ee\backslash (u,v)} \tilde{\phi}_{vu}(x_v, x_u).
\end{equation}
Similarly, we have $p^{\backslash (u,v)}(\bm{x})$ as all other factors except for ${\phi}_{uv}(x_u, x_v)$. Assume that we already have had $q^{\backslash (u,v)}(\bm{x})$ as a good approximation of $p^{\backslash (u,v)}(\bm{x})$, i.e. $q^{\backslash (u,v)}(\bm{x}) \simeq p^{\backslash (u,v)}(\bm{x})$, it is $\tilde{\phi}_{uv}(x_u, x_v)$ that remains to be refined. 
Then the problem $\uargmin{\tilde{\phi}_{uv}^{\mathrm{new}}} \Dd_{\alpha}\left(  p^{\backslash (uv)}\phi_{uv}\|q^{\backslash (u,v)}\tilde{\phi}_{uv}^{\mathrm{new}}\right)$ becomes \vspace{-0.3cm}
\begin{equation}
  \uargmin{\tilde{\phi}_{uv}^{\mathrm{new}}(x_u, x_v)}
  \Dd_{\alpha}\left( q^{\backslash (u,v)}(\bm{x}){\phi}_{uv}(x_u, x_v)
    \|q^{\backslash (u,v)}(\bm{x})\tilde{\phi}_{uv}^{\mathrm{new}}(x_u, x_v) \right),
\end{equation}
which searches for new factor $\tilde{\phi}_{uv}^{\mathrm{new}}(x_u, x_v)$ such the above divergence is minimized.
Using \autoref{eq:fixed-point-iter}, the above problem is equivalent to
\begin{align}\label{eq:update-rule}
  &q^{\backslash (u,v)}(\bm{x})\tilde{\phi}_{uv}^{\mathrm{new}}(x_u, x_v)  \nonumber\\
  &\propto \text{proj}\left[ \left( q^{\backslash (u,v)}(\bm{x}){\phi}_{uv}(x_u, x_v) \right)^{\alpha} \left(q^{\backslash (u,v)}(\bm{x})\tilde{\phi}_{uv}(x_u, x_v)  \right)^{1-\alpha} \right] \nonumber \\
  & \propto \text{proj}\left[ q^{\backslash
    (u,v)}(\bm{x}){\phi}_{uv}(x_u, x_v)^{\alpha} \tilde{\phi}_{uv}(x_u, x_v)^{1-\alpha} \right].
\end{align}

Let us refine one message per time on edge $(u,v)$. Without lose of generality, we update $m_{uv}$ and denote
\begin{equation}
  \tilde{\phi}_{uv}^{\mathrm{new}}(x_u, x_v) = m_{uv}^{\mathrm{new}}(x_v) m_{vu}(x_u).
\end{equation}
Since KL-projection to a fully factorized distribution reduces to matching the marginals, \autoref{eq:update-rule} is reduced to
\begin{equation}\label{eq:message-update}
  \sum_{\bm{x}\backslash x_v} q^{\backslash (u,v)}(\bm{x}) \tilde{\phi}_{uv}^{\mathrm{new}}(x_u, x_v) \propto \sum_{\bm{x}\backslash x_v} q^{\backslash (u,v)}(\bm{x}) \phi_{uv}(x_u, x_v)^{\alpha} \tilde{\phi}_{uv}(x_u, x_v)^{1-\alpha}.
\end{equation}
We use summation here. But it should be replaced by integral if $\Aa$ is a continuous set.
Solving \autoref{eq:message-update} gives the message passing rule as
\begin{equation}\label{eq:message-rule}
  {m}^{\text{new}}_{uv}(x_v) \propto & m_{uv}(x_v)^{1-\alpha} \bigg[
  \sum_{x_u} \phi_{uv}(x_u, x_v)^{\alpha} {m}_{vu}(x_u)^{1-\alpha}
  \tilde{\phi}_u(x_u) \prod_{w\in \Nn(u)\backslash v}\phi_{wu}(x_w,x_u) \bigg].
\end{equation}

As for the singleton factor $\tilde{\phi}_v(x_v)$, we can do the refinement procedure on $\tilde{\phi}_v(x_v)$ in the same way as we have done for $\tilde{\phi}_{uv}(x_u, x_v)$. This gives us the update rule of $\tilde{\phi}_v(x_v)$ as
\begin{equation}\label{eq:fix-factor-update}
  \tilde{\phi}_v^{\text{new}}(x_v) \propto \phi_v(x_v)^{\alpha} \tilde{\phi}_v(x_v)^{1-\alpha},
\end{equation}
which is the belief from factor $f_v(x_v)$ to variable $x_v$. Note, if
we initialize $\tilde{\phi}_v(x_v) = \phi_v(x_v)$, then it remains the
same in all iterations, which makes
\begin{equation}\label{eq:message-rule}
  {m}^{\text{new}}_{uv}(x_v) \propto & m_{uv}(x_v)^{1-\alpha} \bigg[
  \sum_{x_u} \phi_{uv}(x_u, x_v)^{\alpha} {m}_{vu}(x_u)^{1-\alpha}
  {\phi}_u(x_u) \prod_{w\in \Nn(u)\backslash v}\phi_{wu}(x_w,x_u) \bigg].
\end{equation}



\subsection{Remarks on $\alpha$-BP}\label{subsec:remark}
\begin{figure}[!ht]
  \begin{centering}
    \begin{tikzpicture}
      % \tikzstyle{enode} = [thick, draw=blue, circle, inner sep = 3pt,
      % align=center]
      \tikzstyle{enode} = [thick, draw=blue, circle, inner sep = 4pt,  align=center]
      \tikzstyle{nnode} = [thick, rectangle, rounded corners = 2pt,minimum size = 0.8cm,draw,inner sep = 2pt]

      \tikzstyle{cnode} = [thick, cloud, draw,cloud puffs=10, cloud puff arc=120, aspect=2, inner ysep=4pt]

      \node[cnode] (paik) at (0, 1.5) {$\Tt_{\text{Pa}[i]}$};

      \node[enode] (xi) at (0 ,0) {$x_i$};
      \node[nnode] (fi) at (0 , -1.5) {$f_i(x_i)$};
      \node[nnode] (pi) at (2, 0) {$\hat{p}_i(x_i)$};
      % connections
      \draw[-] (xi) to (fi);
      \draw[-] (xi) to (pi);
      \draw[-] (xi) to (paik);
    \end{tikzpicture}
    \caption{Factor graph illustration with prior factor.}\label{fig:factor-graph-with-prior}
    \vspace{0.1cm}
  \end{centering}
\end{figure}

As discussed in Section~\ref{sec:preliminary}, $KL(p\|q)$ is the special case of $\Dd_{\alpha}(p\|q)$ when $\alpha \rightarrow 1$. When applying $\alpha=1$ to \autoref{eq:message-rule}, it gives
\begin{equation}
   {m}^{\text{new}}_{uv}(x_v) \propto & \bigg[
  \sum_{x_u} \phi_{uv}(x_u, x_v) {\phi}_u(x_u) \prod_{w\in \Nn(u)\backslash v}\phi_{wu}(x_w,x_u) \bigg],
\end{equation}
which is exactly the messages of BP in Chapter~$8$ of \cite{Bishop:2006:PRM:1162264}. From this point of view, $\alpha$-BP generalizes BP.

Inspired by \cite{pseudo_priorBP2010} and assembling methods \cite{James:2014:ISL:2517747}, we can add an extra singleton factor to each $x_i$ as prior information that is obtained from other (usually weak) methods. This factor stands for our belief from exterior estimation. Then run our $\alpha$-BP. Denote the prior by $\hat{p}_i(x_i)$ for variable node $x_i$, then the factor graph including this prior belief can be represented as in \autoref{fig:factor-graph-with-prior}.

We summarize the method into the pseudo-code in Algorithm~\autoref{alg:alphaBP}. Though we explain the method with a binary MRF, it is straightforward to replace the factor $t_k$ by a factor involving more than two variables and applies $\alpha$-BP to general factor graphs.
\begin{algorithm}
  \caption{Algorithm of $\alpha$-BP}\label{alg:alphaBP}
  \begin{algorithmic}[1]
    \renewcommand{\algorithmicrequire}{\textbf{Input:}}
    \renewcommand{\algorithmicensure}{\textbf{Output:}}
    \REQUIRE Factor graph of $p(\bm{x})$
    \STATE Initialize $q(\bm{x})$
    \IF {Prior belief on $x_i$ available}
    \STATE Add prior factor as \autoref{fig:factor-graph-with-prior}
    \ENDIF
    \WHILE{not converge}
    \FOR {each edge of factor graph}
    \STATE Message update by \autoref{eq:message-rule} or \autoref{eq:fix-factor-update}
    \ENDFOR
    \ENDWHILE
    \RETURN $q(\bm{x})$ 
  \end{algorithmic} 
\end{algorithm}


\bibliographystyle{IEEEtran}

% \bibliography{bibliography}
\bibliography{myref}

% \appendix

% \input{section/sec-appendixA}
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
